# Lizard Cellular Automata modeling
By Danny Kang, Jeremy Ryan, and Nick Sherman
 
## **Abstract**
In ocellated lizards, patterns can be observed on their skin due to green and black labyrinthine patterns created by their lizard scale color. We wish to analyze how such patterns can form through using data gathered from ocellated lizards as they mature and mimic the pattern produced through cellular automaton. </ br>
We developed manukyan model based on cellular automata to simulate changes in lizard network. The manukyan model contains table of probability values that determines the likeliness of color change of each scale in network. We extended our model by adding brown and white state to green and black state. Furthermore, we experimented with deterministic behaviour in cellular automata to see difference in behavior of model. Pygame was used to visualize the simulation of our model and networkx and matplotlib were used to transform our model to graphs to conduct deeper graphical analysis.
---
## **Annotated bibliography**
 
### A living mesoscopic cellular automaton made of skin scales 
Liana Manukyan, Sophie A. Montandon, Anamarija Fofonjka, Stanislav  Smirnov, Michel C. Milinkovitch <br />
https://www.nature.com/articles/nature22031#extended-data<br />
This paper proposes a cellular automata model to replicate patterns in ocellated lizards as they age. Their model, which used hexagonal scales that were either green or black in color, produced results with similar scale distributions and results visually closer to real lizards than a random distribution, suggesting that scale color is actually affected by the color of nearby scales.
 
### How animals get their skin patterns: fish pigment pattern as a live Turing wave
Kondo S, Iwashita M, Yamaguchi M.<br />
https://www.ncbi.nlm.nih.gov/pubmed/19557690?dopt=Abstract&holding=npg<br />
This paper analyzed Turing’s idea that spatial patterns autonomously made in the embryo are generated by a stationary wave of cellular reactions. This paper was able to strongly correlate specific genes attributed to at least part of the cellular reactions driving this by analyzing zebrafish’s patterns over the course of their first few weeks of life after identifying mutants in the zebrafish’s population and comparing them to the original fish. They also compared these mutants to normal zebrafish whose stripes were erased via laser light in other work.
 
### Reaction-diffusion model as a framework for understanding biological pattern formation 
Liana Manukyan, Sophie A. Montandon, Anamarija Fofonjka, Stanislav Smirnov, Michel C. Milinokovitch<br />
https://science.sciencemag.org/content/sci/329/5999/1616.full.pdf<br />
This paper explains about the reaction-diffusion model or Turing model and emphasizes its role in understanding spatial skin pattern formation of vertebrates and suggests possible applications of this model. The paper acknowledges the difficulty of applying two dimensional Turing model to complex biological system and mentions a few discoveries that made possible the application of Turing model. According to paper, Gierer and Meinhardt showed that a system needs only to include a network that combines “”a short-range positive feedback with a long-range negative feedback” to generate a Turing pattern, which is now accepted as the basic requirement for Turing pattern formation. Modern genetic and molecular techniques makes it possible to identify such elements of interactive networks in living organisms. Further analysis is possible by predicting dynamic properties of the pattern using computer simulation. Also according to paper, observation of the dynamic properties of Turing patterns in nature was made by Kondo and Asai in a study of horizontal stripes in the tropical fish, Pomacanthus imperator. Paper ends in a positive note about applying Turing model by saying that artificial generation of Turing patterns in cell culture should be possible in the near future as the result of synthetic biology. 
 
---
## **Experiments**
 
For our experiments, we replicated and extended the cellular automaton model from the Manukyan paper and performed some analysis. We used Pygame to visualize the model, and were able to simulate it over time.
![CA model](https://raw.githubusercontent.com/kdy304g/ComplexLizards-CA/master/images/visual.png)
 
### 1. Manukyan model for green black states
 
Our first-pass model was a direct implementation of the model used in the Manukyan paper.
For each cell color, based on its number of like-colored neighbors, there is a probability of changing state before the next time step, copied from the Manukyan paper using Logger Pro. For instance, if a green cell has exclusively black neighbors, there is a 0% chance of changing state. This increases as the number of like-colored cells increases.
The original paper, having built the model from graphs of actual lizard scales, has probabilities that may be slightly skewed from our own. Actual scales are not perfectly hexagonal, and sometimes there are scales with more or fewer than six neighbors. As such, there were entries in the original paper for probability with seven like-colored neighbors which were not used in our model.
 Following is the average probability mass function graph for both green and black scales after this model stabilizes. 
 
<img src="https://github.com/kdy304g/ComplexLizards-CA/blob/master/images/stablized.png" width="500" height="500" style="text-align:center"/>
 
As far as the distribution of number of neighbors is concerned, the result above closely resembles the actual result of lizards in terms of shape. However, our model peaks at 2 neighbors for green scales and 3 neighbors for black scales whereas the actual model peaks at 3 neighbors for green scales and 4 neighbors for black scales. One potential cause for this difference is the values of the probabilities in the table. 
 
 
### 2. Adding brown white states
 
One of the interesting observations about the ocellated lizard is the change in color of their scales from white/brown to green/black. As part of this, we conjectured that the change in color over time could be modelled one of two ways: either as cellular automata with discrete color values that can flip after a specified amount of time steps or as fluid values that change dynamically over time. 
 
The first (and easier) experiment that we implemented was the set possible states of colors. We wanted to see how the color distribution changed over time and see if we can visually mimic what the ocellated lizards do while maintaining similar black:green ratios at the end of the simulation (the papers did not give a brown:white ratio to compare to). What we observed was that visually it looks similar to the ocellated lizards’ skin over time, with the major difference being that the colors change suddenly (as is expected). For the end color distribution, we found that ________ (full analysis TBD based on more graphs).
 
### 3. Deterministic model
 
<img src="https://github.com/kdy304g/ComplexLizards-CA/blob/master/images/deterministic_graph.png" width="500" height="500" style="text-align:center"/>
 
For the deterministic model of lizard, we used two rules for cellular automata. First rule is to convert green scale to black scale when there are more than 3 black neighbors. The second rule is to convert black scale to green scale when there are more than 2 green neighbors. To our disappointment, running the model based on these two rules produced extreme behavior, which is all scales except for few scales at corner turning to green in less than 10 steps. 
 
### 4. Graphical Analysis 
 
<img src="https://github.com/kdy304g/ComplexLizards-CA/blob/master/images/graph_analysis.png" width="500" height="500" style="text-align:center"/>
 
To be updated with more analysis

[![Pmf initial](https://github.com/kdy304g/ComplexLizards-CA/blob/master/images/PMF_initial.png)]  | [![
Pmf 300steps](https://github.com/kdy304g/ComplexLizards-CA/blob/master/images/PMF_300steps.png)]

